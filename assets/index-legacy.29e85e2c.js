System.register(["./vendor-legacy.e71c8e14.js","./index-legacy.b24d49a4.js","./index-legacy.b2e53b1b.js","./index-legacy.7a45e14c.js"],(function(e){"use strict";var t,a,l,s,r,n,o,i,d,u,c,m,p,y,f,b,w,h,v,g,q,S,x;return{setters:[function(e){t=e.d,a=e.r,l=e.s,s=e.u,r=e.q,n=e.M,o=e.G,i=e.aU,d=e.E,u=e.b8,c=e.e,m=e.i,p=e.w,y=e.j,f=e.l,b=e.b},function(e){w=e._,h=e.a},function(e){v=e.A,g=e.R,q=e.j,S=e.l},function(e){x=e.g}],execute:function(){var D;function T(e){return v.request({url:[D.adminAccount,e].join("/"),method:g.DELETE},{isShowErrorMessage:!0,successMessageText:"删除成功"})}(D||(D={})).adminAccount="/admin/account";const P=()=>({formItem:[{type:"input",label:"用户名",field:"username",value:"",props:{placeholder:"请输入用户名"},rules:[{required:!0,message:"用户名不能为空"}]},{type:"input",label:"密码",field:"password",hidden:!1,value:"",props:{type:"password",placeholder:"请输入密码"},rules:[{required:!0,message:"密码不能为空"}]},{type:"checkbox",label:"角色",field:"roles",value:[],options:[],loading:!0,rules:[{required:!0,message:"请选择角色",type:"array"}],asyncOptions:async()=>{const{data:e}=await x({});return e.map((e=>({label:e.title,value:e.id})))}}]}),R=[{title:"用户名",dataIndex:"username"},{title:"所属角色",dataIndex:"roles",slots:{customRender:"roles"},slotsType:"format",slotsFunc:e=>e.map((e=>e.title)).join(", ")},{title:"创建时间",dataIndex:"createdAt",slots:{customRender:"createdAt"},slotsType:"format",slotsFunc:e=>q(e)},{title:"最后更新时间",dataIndex:"updatedAt",slots:{customRender:"updatedAt"},slotsType:"format",slotsFunc:e=>q(e)},{title:"操作",dataIndex:"action",width:200,slots:{customRender:"action"},actions:[{type:"popconfirm",text:"删除",permission:{action:"delete",effect:"disabled"},props:{type:"danger"},func:async({record:e},t)=>await T(e.id).then((()=>t()))},{type:"button",text:"编辑",permission:{action:"update",effect:"disabled"},props:{type:"warning"},func:({record:e},t)=>S({title:"编辑账号",fields:{...e,roles:e?.roles.map((e=>e.id))},hiddenFields:["password"],formSchema:P(),handleOk:async(a,l)=>{const{username:s,password:r,roles:n}=a,o={username:s,password:r,roles:n.toString()};return await function(e,t){return v.request({url:[D.adminAccount,e].join("/"),method:g.PATCH,params:t},{isShowErrorMessage:!0,successMessageText:"修改成功"})}(e.id,o).then((()=>t()))}})}]}];var A=e("default",t({name:"SystemAccount",components:{DynamicTable:w,TableQueryHeader:h},setup(){const e=a(),t=l({queryParam:{name:"",status:"",startDate:"",endDate:""},tableLoading:!1,rowSelection:{onChange:(e,a)=>{t.rowSelection.selectedRowKeys=e},selectedRowKeys:[]}}),d=s((()=>0==t.rowSelection.selectedRowKeys.length));return{...r(t),columns:R,tableRef:e,isDisabled:d,loadData:e=>function(e){return v.request({url:D.adminAccount,method:g.GET,params:e},{isShowErrorMessage:!0})}({...e,...t.queryParam}),addItem:()=>{S({title:"添加账号",formSchema:P(),handleOk:async(t,a)=>{const{username:l,password:s,roles:r}=t,n={username:l,password:s,roles:r.toString()};await function(e){return v.request({url:D.adminAccount,method:g.POST,params:e},{isShowErrorMessage:!0,successMessageText:"新建成功"})}(n),e.value?.refreshTableData()}})},deleteItems:()=>{n.confirm({title:"提示",icon:o(i),content:"您确定要删除所有选中吗？",onOk:async()=>{await T(t.rowSelection.selectedRowKeys.toString()),e.value?.refreshTableData(),t.rowSelection.selectedRowKeys=[]}})}}}}));const k=["label"],_=["label"],I=b("请选择"),j=b("已停用"),E=b("已启用"),C=["label"],M=["label"],K=b("查询"),L=b("重置"),O=b(" 添加 "),U=b(" 删除 ");A.render=function(e,t,a,l,s,r){const n=d("a-input"),i=d("a-select-option"),b=d("a-select"),w=d("a-date-picker"),h=d("a-button"),v=d("table-query-header"),g=d("dynamic-table"),q=u("permission");return c(),m("div",null,[o(v,null,{item:p((({setLabel:a})=>[y("div",{label:a("账号名称")},[o(n,{value:e.queryParam.name,"onUpdate:value":t[0]||(t[0]=t=>e.queryParam.name=t),placeholder:""},null,8,["value"])],8,k)])),item2:p((({setLabel:a})=>[y("div",{label:a("状态")},[o(b,{value:e.queryParam.status,"onUpdate:value":t[1]||(t[1]=t=>e.queryParam.status=t),placeholder:"请选择","default-value":""},{default:p((()=>[o(i,{value:""},{default:p((()=>[I])),_:1}),o(i,{value:"0"},{default:p((()=>[j])),_:1}),o(i,{value:"1"},{default:p((()=>[E])),_:1})])),_:1},8,["value"])],8,_)])),item3:p((({setLabel:a})=>[y("div",{label:a("开始日期")},[o(w,{value:e.queryParam.startDate,"onUpdate:value":t[2]||(t[2]=t=>e.queryParam.startDate=t),style:{width:"100%"},placeholder:"开始日期"},null,8,["value"])],8,C)])),item4:p((({setLabel:a})=>[y("div",{label:a("结束日期")},[o(w,{value:e.queryParam.endDate,"onUpdate:value":t[3]||(t[3]=t=>e.queryParam.endDate=t),style:{width:"100%"},placeholder:"结束日期"},null,8,["value"])],8,M)])),buttons:p((()=>[o(h,{type:"primary",onClick:t[4]||(t[4]=t=>e.tableRef?.refreshTableData({},!0))},{default:p((()=>[K])),_:1}),o(h,{style:{"margin-left":"8px"},onClick:t[5]||(t[5]=()=>e.queryParam={})},{default:p((()=>[L])),_:1})])),_:1}),o(g,{ref:"tableRef",columns:e.columns,"get-list-func":e.loadData,rowKey:"id","row-selection":e.rowSelection},{title:p((()=>[f(o(h,{type:"primary",onClick:e.addItem},{default:p((()=>[O])),_:1},8,["onClick"]),[[q,{action:"create",effect:"disabled"}]]),f(o(h,{disabled:e.isDisabled,type:"primary",onClick:e.deleteItems},{default:p((()=>[U])),_:1},8,["disabled","onClick"]),[[q,{action:"delete"}]])])),_:1},8,["columns","get-list-func","row-selection"])])}}}}));
